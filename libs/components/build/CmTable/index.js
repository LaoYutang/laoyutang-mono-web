"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const u=require("element-plus/es"),e=require("vue"),y=require("utils");const S={class:"cm-table"},B={key:0,class:"buttons"},T={class:"table"},N={class:"pager"},V=e.defineComponent({name:"CmTable"}),E=e.defineComponent({...V,props:{getData:null,isInitData:{type:Boolean,default:!0},initParams:{default:()=>({})},isUsePager:{type:Boolean,default:!0},isUseCheckBox:{type:Boolean,default:!0}},setup(a,{expose:d}){const n=a,r=e.ref([]),s=e.ref(!1),p=e.ref({}),o=e.reactive({pageSize:20,currentPage:1}),m=e.ref(0),v=e.ref(null),c=(t,l=!0)=>(t&&(p.value=y._deepClone(t)),l&&(o.currentPage=1),n.isUsePager&&(p.value.pager=o),s.value=!0,n.getData(p).then(i=>{r.value=i.datas,m.value=i.total}).catch().finally(()=>{s.value=!1}));n.isInitData&&c(n.initParams),e.watch(()=>o.currentPage,()=>{c(null,!1)}),e.watch(()=>o.pageSize,()=>{c()});const _=e.ref([]),b=t=>{_.value=t},C=e.reactive({a:1});return d({update:c,selection:_,test:C}),(t,l)=>{const i=u.ElTableColumn,P=u.ElTable,k=u.ElPagination,h=u.ElLoadingDirective;return e.withDirectives((e.openBlock(),e.createElementBlock("div",S,[e.createCommentVNode(" 操作按钮组 "),t.$slots.buttons?(e.openBlock(),e.createElementBlock("div",B,[e.renderSlot(t.$slots,"buttons",{selection:e.unref(_)},void 0,!0)])):e.createCommentVNode("v-if",!0),e.createCommentVNode(" 表格主体 "),e.createElementVNode("div",T,[e.createVNode(P,e.mergeProps({ref_key:"table",ref:v},t.$attrs,{data:e.unref(r),onSelectionChange:b}),{default:e.withCtx(()=>[n.isUseCheckBox?(e.openBlock(),e.createBlock(i,{key:0,type:"selection"})):e.createCommentVNode("v-if",!0),e.renderSlot(t.$slots,"default",{},void 0,!0)]),_:3},16,["data"])]),e.createCommentVNode(" 分页部分 "),e.createElementVNode("div",N,[e.createVNode(k,{"page-size":e.unref(o).pageSize,"onUpdate:pageSize":l[0]||(l[0]=g=>e.unref(o).pageSize=g),"current-page":e.unref(o).currentPage,"onUpdate:currentPage":l[1]||(l[1]=g=>e.unref(o).currentPage=g),background:"",layout:"total, prev, pager, next","hide-on-single-page":"",total:e.unref(m)},null,8,["page-size","current-page","total"])])])),[[h,e.unref(s)]])}}});const z=(a,d)=>{const n=a.__vccOpts||a;for(const[r,s]of d)n[r]=s;return n},f=z(E,[["__scopeId","data-v-978dd10c"]]),D={install(a){a.component(f.name,f)}};exports.CmTable=f;exports.default=D;
