"use strict";var j=Object.defineProperty;var O=(r,t,e)=>t in r?j(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var p=(r,t,e)=>(O(r,typeof t!="symbol"?t+"":t,e),e),S=(r,t,e)=>{if(!t.has(r))throw TypeError("Cannot "+e)};var M=(r,t,e)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,e)};var l=(r,t,e)=>(S(r,t,"access private method"),e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const T=require("../node_modules/.pnpm/registry.npmmirror.com_axios@1.3.3/node_modules/axios/lib/axios.js"),P=require("../common.js");var i,d;class x{constructor(t,e){M(this,i);p(this,"instance");p(this,"requestMap");p(this,"customConfig");this.instance=T.default.create(t),this.requestMap=new Map,this.customConfig=e,this.instance.interceptors.request.use(e==null?void 0:e.requestHandler,a=>Promise.reject(a)),this.instance.interceptors.response.use(e==null?void 0:e.responseHandler,e==null?void 0:e.responseErrorHandler)}request(t,e,a,s){var y;const n=t+a+JSON.stringify(e);if(this.requestMap.has(n))return this.requestMap.get(n);const[h,b]=a.split("/"),w=b==="formdata"?"application/x-www-form-urlencoded":"application/json";s!=null&&s.trimString&&l(this,i,d).call(this,e);const c={...s==null?void 0:s.merge,url:t,method:h,params:h==="get"?e:{},data:h==="get"?{}:e,headers:Object.assign({},(y=s==null?void 0:s.merge)==null?void 0:y.headers,{"content-type":w})},q=this.instance.request(c);return this.requestMap.set(n,q),q.finally(()=>{var u;setTimeout(()=>{this.requestMap.delete(n)},((u=this.customConfig)==null?void 0:u.expire)??500)}),q}}i=new WeakSet,d=function(t){for(const e in t)if(t.hasOwnProperty(e))switch(P._getVarType(t[e])){case"String":{t[e]=t[e].trim();break}case"Object":case"Array":{l(this,i,d).call(this,t[e]);break}}};exports._Request=x;
